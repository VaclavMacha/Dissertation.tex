\documentclass[twoside, a4paper, 11pt]{book}
\input{preamble.tex}
\input{styles.tex}

% ------------------------------------------------------------------------------
% Affiliation
% ------------------------------------------------------------------------------
\title{General Framework for Classification at the Top}
\subtitle{Dissertation}

\author{Ing. Václav Mácha}
\branch{Matematické inženýrství}
\academicyear{2022/2023}
\date{1. prosince 2022}
\supervisor{doc. Ing Václav Šmídl, Ph.D.}
\supervisorspec{Mgr. Lukáš Adam, Ph.D.}

\acknowledgment{Thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks thanks}

\titleCZE{Title title title title title title}

\thesistype{Disertační práce}

\abstractCZE{Abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract abstract}

\keywordsCZE{Keywords keywords keywords keywords keywords keywords keywords keywords keywords keywords keywords keywords keywords}

\titleENG{General Framework for Classification at the Top}

\abstractENG{Many binary classification problems minimize misclassification above (or below) a threshold. We called this problem a classification at the top since the performance is evaluated only on a small number of relevant (top) samples. We show that instances of ranking problems, accuracy at the top, or hypothesis testing may be written similarly. We propose a general framework to handle these classes of problems and show which formulations (both known and newly proposed \PatMat and \PatMatNP) fall into this framework. We provide a theoretical analysis of this framework when used with a linear model and mention selected possible pitfalls the formulations may encounter. We show the convergence of the stochastic gradient descent for selected formulations even though the gradient estimate is inherently biased. Moreover, we derived dual forms of selected formulations and introduced a new coordinate descent algorithm to solve them. We also study the case when the selected formulations are used with non-linear models (for example, arbitrary deep neural network). Since the threshold depends on all samples, the resulting optimization problem is non-decomposable. We modify the stochastic gradient descent to handle the non-decomposability in an end-to-end training manner. We propose a way to estimate the threshold only from values on the current minibatch. Finally, we propose a new \DeepTopPush formulation that uses enhanced mini-batches to estimate the true threshold better. We demonstrate the performance of proposed formulations on visual recognition datasets and a real-world application on steganalysis and malware detection.}

\keywordsENG{Binary classification, ranking, accuracy at the top, Neyman-Pearson, hypothesis testing}


% ------------------------------------------------------------------------------
% Document
% ------------------------------------------------------------------------------
\begin{document}

\maketitle

\input{chapters/introduction.tex}
\input{chapters/binary_classification.tex}
\input{chapters/framework.tex}
\input{chapters/primal.tex}
\input{chapters/dual.tex}
\input{chapters/deep.tex}
\input{chapters/experiments.tex}
\input{chapters/conclusion.tex}

% ------------------------------------------------------------------------------
% Appendix
% ------------------------------------------------------------------------------
\part*{Apendices}
\appendix

\input{chapters/framework_appendix.tex}
\input{chapters/primal_appendix.tex}
\input{chapters/dual_appendix.tex}
\input{chapters/deep_appendix.tex}

% ------------------------------------------------------------------------------
% Bibliography
% ------------------------------------------------------------------------------
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}
\bibliography{references.bib}
\bibliographystyle{unsrt}

\end{document}
